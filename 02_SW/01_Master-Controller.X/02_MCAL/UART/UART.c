/**
 * \file       Source.c
 * \author     Ioan Nicoara
 * \brief      Short description for this source file
 */

/*----------------------------------------------------------------------------*/
/*                                 Includes                                   */
/*----------------------------------------------------------------------------*/
#include "UART.h"
#include "../GPIO/GPIO.h"
/*----------------------------------------------------------------------------*/
/*                               Local defines                                */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*                              Local data types                              */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*                             Global data at RAM                             */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*                             Global data at ROM                             */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*                             Local data at RAM                              */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*                             Local data at ROM                              */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/*                       Declaration of local functions                       */
/*----------------------------------------------------------------------------*/
/**
 * \brief     This function [...];
 * \param     None
 * \return    None 
 */
/*----------------------------------------------------------------------------*/
/*                     Implementation of global functions                     */
/*----------------------------------------------------------------------------*/
void UART1_vInit(void)
{
    GPIO_vSetPinDirection(0xC6, GPIO_OUTPUT_PIN); // PIN C6 set as input
    GPIO_vSetPinDirection(0xC7, GPIO_INPUT_PIN); // PIN C7 set as input
    RC6PPS = 0x13;// set TX on PORTC pin 6
    RC7PPS = 0x17;// set RX on PORTC pin 7 
    
    U1CON0 = 0xB0;
    U1CON1 = 0x80;
    //U1CON2 = 0x02; //HW flow control RTS/CTS 
    U1ERRIR = 0x00;
    U1ERRIR = 0x00;
    U1UIR = 0x00;
    U1FIFO = 0x00;
   U1BRG = 0x682;
    U1P1 = 0x00;
    U1P2 = 0x00;
    U1P3 = 0x00;
    U1TXCHK  = 0x00;
}

void UART1_uiTransmitter(uint8_t valSend)
{
    
    while(0 == MASK_8BIT_GET_BIT(PIR3,4)) // TX complete
    {
    }
    U1TXB = valSend; 
}

uint8_t UART1_uiReception(/*uint8_t * var */ )
{
//    uint8_t returnValue = 0;
//    if(1 == U1RXBF)
//    {
//        returnValue = 1;
//        *var = U1RXB;
//    }
//    return  returnValue;
    return U1RXB;
}

void UART_vOperationMode(uint8_t reg, uint8_t mode)
{
    
}
/*----------------------------------------------------------------------------*/
/*                     Implementation of local functions                      */
/*----------------------------------------------------------------------------*/


        